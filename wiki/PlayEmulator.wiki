#summary 操作 Android 模擬器
#labels tw,Emulator

= 使用 Android 模擬器 =

我們已經開啟了 ApiDemos 專案。現在先不忙著開始寫程式，我們花點時間，來看看怎麼執行一個 Android 程式吧。

要執行 ApiDemos 程式前，我們得在開發環境中，事先設定好一些用來執行 ApiDemos 程式的環境參數。
以後使用其他程式專案時，我們也能用同樣的方式，讓這些程式在我們的開發環境中運行。

首先，我們透過選單列上的「Run」(執行)選單，選擇「開啟執行參數設定」(Run-> Debug Configurations...) 進入運行環境參數設定畫面。

進入設定畫面後，在視窗左側會有一整排 Eclipse 支援的運行設定，我們從中找到 "Android Application"(Android 應用程式)項目，按下滑鼠右鍵，點選 "New"(新增)選項。

選擇 「New」 選項後，在「Android Application」項目下方會多出一筆執行項目。

我們可以在 Name 欄位上輸入一個代表這個環境參數的名稱，在此我們輸入與專案名稱相同的「ApiDemos」。

在「Project」欄位右方，點選「Browse...」按鈕，開啟「專案選擇」（Project Selection）視窗，選擇「ApiDemos」專案並點選「OK」按鈕，以選擇要執行的專案。

在 「Launch Action」 選單中，確認預設選擇的是「Launch Default Activity」。

至此我們就完成了模擬器環境參數的設定。 點選右下角的「Debug」按鈕，Eclipse 就會啟動 Android 模擬器。

小技巧: 
    在選單列中，也可以選擇設定「Run Configuration...」選項。這時我們得到的是一個幾乎完全相同的環境參數設定畫面，只是右下角的「Debug」按鈕變成了「Run」按鈕。「Debug」與「Run」模式的環境參數設定可以共用，差別在於「Debug」模式下可以使用在之後章節中會介紹的 logd，來顯示一些開發時所需的額外訊息。

== 再次啟動 Android 模擬器 ==當我們設定好之後，以後碰到要再次啟動模擬器的情況時，只要在螢幕左上角的「Debug」或「Run」圖示右側小箭頭上按一下，從彈出的選單中選擇剛剛設定的環境參數名稱，模擬器即開始執行，並安裝好我們所指定的專案應用程式。

= 操作 Android 模擬器 =

== 切換模擬器佈景 ==

在選單列上，選擇「Run-> Debug Configurations...」，進入運行環境參數設定畫面。在參數設定畫面中，選擇 Target 標籤，其中「Screen Size:」欄位中會列出所有支援的模擬器佈景。預設有「HVGA」與「QVGA」可選擇，「HVGA」與「QVGA」又可以再各自分為「-L」(landscape, 橫式) 與「-P」(portrait 橫式)。


== 切換螢幕 ==

在 Windows 作業系統上按下「F7」鍵，或是在 Mac OS X 作業系統上同時按下「fn」 和「7」鍵，螢幕就會從預設的直式顯示改成橫式顯示，再按一次則切換回原來的直式顯示。


== 新增模擬器佈景 ==

模擬器的用途，就是協助我們在電腦上也能模擬真實手機的動作。不禁會想，如果模擬器除了所模擬的動作之外，模擬器的外觀也能跟實機長的一樣，那不是整個更擬真，開發起來更有感覺嗎？

是的，Android 的模擬器也允許使用者自行製作模擬器佈景！

以世界第一台發售的 Android 手機「T-Mobile G1」為例，有人已經製作好了「T-Mobile G1」的模擬器佈景。可以前往 http://www.jsharkey.org/downloads/G1.zip 下載。

要新增模擬器佈景時，只需把下載後的模擬器佈景解開成一個資料夾，再將資料夾放到「android_sdk/tools/lib/images/skins」目錄下。做完後打開 Eclipse 開發環境的選單列，選擇「Run-> Debug Configurations...」，進入運行環境參數設定畫面。在參數設定畫面中，選擇 Target 標籤，其中「Screen Size:」欄位中所列出的模擬器佈景即新增加了「G1」一項(可自行命名)。

== 移除模擬器佈景 ==

要移除一個模擬器佈景，直接刪除在「android_sdk/tools/lib/images/skins」中的對應目錄即可。

== 移除程式 ==

我們已經順利地啟動了模擬器，那麼，該怎麼移除安裝到模擬器上的程式哩?

Android SDK 中提供一個 adb (Android Debugger) 命令行工具 (在 android-sdk/tools 中)，我們可以用裡面的 shell 工具連上模擬器來移除應用程式。在某些平台上，這些動作可能需要擁有 root 權限才能執行。

首先啟動 adb shell
{{{
    $ adb shell
}}}
接著切換到 data/app 目錄中
{{{
    $ cd data/app/
}}}
使用 ls 命令(等同 windows 上命令行的 dir 命令)來檢視檔案列表
{{{
    # ls
    -rw-r--r-- system   system    1325833 2007-11-11 20:59 ApiDemos.apk
}}}

接著使用 rm 命令來刪除 ApiDemos 應用程式
{{{
    # rm ApiDemos.apk
    # ls
}}}

== 移除映像檔 ==

模擬器的映像檔會保存住你之前安裝的程式與操作。所以當你想要回覆一個乾淨的模擬環境時，你得先移除模擬器的映像檔。

{{{
在 Windows 上，模擬器的映像檔會保存在 C:\Documents and Settings\使用者帳號目錄\Local Settings\Application Data\Android\userdata.img 。
在 Mac 或 Linux 上則會保存在 ~/.android/userdata.img 。
}}}

我們可以直接刪除，或在模擬器關閉的狀況下，以指令 
{{{
    $ rm  /.android/userdata.img
}}}
來刪除模擬器的映像檔。


閱讀參考

    * 模擬器操作細節 http://code.google.com/android/reference/emulator.html

< [OpenProject 開啟現有專案] | [DiveIntoAndroid 回目錄] | [ReadSource 建立一個 Android 程式] >