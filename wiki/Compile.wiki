#summary ROM 編譯與更新
#labels draft

= 從頭建立編譯環境 =

== 系統需求 ==

 * 一套 Unix 相容作業系統，如 Ubuntu、Mac OS X（檔案格式要選擇日誌式/區分大小寫）
 * 至少 10G 的硬碟空間
 * RAM 必須超過 1.5G 
 * 可連上網路

== 編譯前需知 ==

Android 原始碼相關資源可在 http://source.android.com/ 官方網站找到。

本教學以 Ubuntu 9.04 為例。

因為編譯整個 Android 系統是極度耗系統資源的工作。請讀者不要浪費時間嘗試在 Windows 上編譯 Android 的方法。 在電腦上留下 10 多 G 硬碟空間裝個 Ubuntu Linux 環境然後照著官方教學走，比在 Windows 下裝 Cygwin 並自行摸索簡單多了。


 * 可透過網路更新編譯 Android 必需的套件

{{{
sudo apt-get update
sudo apt-get install git-core gnupg sun-java5-jdk flex bison gperf libsdl-dev libesd0-dev libwxgtk2.6-dev build-essential zip curl libncurses5-dev zlib1g-dev
}}}


== 下載 Android 原始碼版本管理工具 ==
{{{
mkdir bin
curl http://android.git.kernel.org/repo >~/bin/repo
chmod a+x ~/bin/repo
}}}

== 準備原始碼目錄 ==

{{{
mkdir mydroid
cd mydroid
~/bin/repo init -u git://android.git.kernel.org/platform/manifest.git
}}}


== 配置抓取不同版本 ==

同樣命令後面加上分支版本(branch)代號，如要配置成抓取 cupcake 分支，可用以下命令

{{{
~/bin/repo init -u git://android.git.kernel.org/platform/manifest.git -b cupcake
}}}


== 下載原始碼 ==

{{{
~/bin/repo sync
}}}

== 編譯(預設值) ==
{{{
make
}}}

以 1.6G 雙核的 CPU 來說，從頭編譯 Android 大概需要 5 小時以上時間。直接打「make」命令編譯好的 ROM 只適合模擬器使用。要編譯能在實機上使用的 ROM 需要另外加上其他參數。

== 啟動模擬器 ==

 * 下載 Android SDK 並解壓縮，並將目錄更名為 android_sdk

{{{
cd ~/mydroid/out/target/product/generic
~/android_sdk/tools/emulator -system system.img -data userdata.img -ramdisk ramdisk.img
}}}


待續...

== 參考資料 ==

 * Android 自製 ROM 列表 http://www.androidspin.com/android_build_information.asp
 * 編譯android原始碼到模擬器上執行 http://www.dotblogs.com.tw/neil/archive/2009/04/03/7838.aspx
 * 編譯到機器上執行 http://source.android.com/documentation/building-for-dream
 * Recovery http://forum.xda-developers.com/showthread.php?t=523558

----

= 更新 =

= 待整理資料 =

長按 斷話鍵（紅） 關閉機器。

同時按 斷話鍵/Home 鍵 啟動 Recovery 

或下命令

$ adb shell reboot recovery

（早期）在 recovery 畫面按 alt+s 來開始 update，按 Home + Back 鍵重啟系統。

（現在）畫面上選擇 reboot system


* http://blog.csdn.net/dong_miao/archive/2009/04/13/4068701.aspx
* http://haykuro.theiphoneproject.org/?page_id=35
* Recovery 更新系統 http://android.cool3c.com/article/2482

* adp & fastboot http://www.htc.com/www/support/android/adp.html

* SPL http://code.google.com/p/android-roms/wiki/SPL

* Partition SD Card http://geeks.pirillo.com/profiles/blogs/how-to-partition-an-sd-card

* http://forum.xda-developers.com/showthread.php?t=522076